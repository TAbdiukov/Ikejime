import ikepatcher

AUTHOR = "TAbdiukov"
VERSION = 2

if __name__ == '__main__':
	# D8642404D9993C010000EB0AC7813C01000000000000D9813C010000
	# D8642404D9993C010000EB0AC7813C01000000000000D9813C010000
	# Pts: 111111 2222 333333333333 44444444 555555555555 6666 77777777777777777777777777777777
	# Old: 803900 751C D9813C010000 D8642404 D9993C010000 EB0A C7813C01000000000000D9813C010000
	# New: 803900 EB1C D9813C010000 D8642404 D9993C010000 EB0A C7813C01000000000000D9813C010000

	print("Version: "+str(VERSION))

	old = ikepatcher.InHEX.src("(80 39 00)(75 1C)(D9 81 3C 01 00 00)(D8 64 24 04)(D9 99 3C 01 00 00)(EB 0A)(C7 81 3C 01 00 00 00 00 00 00 D9 81 3C 01 00 00)")

	new = r"\g<1>\xEB\x1C\g<3>\g<4>\g<5>\g<6>\g<7>"

	obj = ikepatcher.Patcher(ikepatcher.Cook(old, new, "TDR2000.exe", "0"))
	obj.payload()
